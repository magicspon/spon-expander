!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.sponExpander=e()}(this,function(){"use strict";"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t,e=(function(t,e){var n;t.exports=(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=n({},{easing:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},duration:1e3},t),a=i.easing,r=i.duration,o=i.start,s=i.end,l=0,c=null,u=null,d=null;return new Promise(function(t){d=window.requestAnimationFrame(function n(i){var p,f,h,v=l||o;u||(u=i),c=i-u,l=Math.round(a(c,o,s-o,r)),p=v,f=l,(o<=(h=s)?f<=h&&p<=f:f>=h&&p>=f)?(d=window.requestAnimationFrame(n),e&&e(l)):(t(v),window.cancelAnimationFrame(d),c=null,u=null,d=null,v=null)})})})}(t={exports:{}},t.exports),t.exports),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return function t(i){var a,r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaults={activeIndex:null,closeOthers:!1,open:!1,selector:"[data-accordion-btn]",name:"accordion",init:!0,buttonActiveClass:"is-active",contentActiveClass:"is-expanded",duration:300,easing:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}},this.clickHandle=function(t,e){e.preventDefault();var n=t.dataset.accordionIndex,i=r.panes[n];i.state=i.machine[i.state].CLICK,"open"===i.state?r.expand(n):r.collapse(n)},this.createPanels=function(){var t=r.options,e=t.buttonActiveClass,n=t.contentActiveClass,i=t.activeIndex,a=t.open,o=t.name;r.panes=[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(r.$el.querySelectorAll(r.options.selector))).map(function(t,s){t.setAttribute("data-accordion-index",s);var l=t.dataset.target,c=r.$el.querySelector(l),u=!!a||!a&&s===i;t.setAttribute("aria-expanded",u),t.setAttribute("aria-selected",u),t.setAttribute("aria-controls",o+"-"+s),u&&(t.classList.add(e),c.classList.add(n)),c.setAttribute("data-enhanced",!0),c.setAttribute("aria-labelledby",o+"-"+s),c.setAttribute("aria-hidden",!u),c.setAttribute("role","tabpanel");var d={$button:t,$target:c,index:s,open:u,isRunning:!1,state:u?"open":"close",machine:{open:{CLICK:"close"},close:{CLICK:"open"}}};return i===s&&(r.current=d),d})},this.animate=function(t,n,i){var a=r.options,o=a.duration,s=a.easing;return e({start:t,end:n,duration:o,easing:s},function(t){return i.style.height=t+"px"})},this.onEnd=function(t){var e=t.$target,n=t.$button,i=t.open;return e.style.willChange="",e.style.height="",e.style.display="",n.setAttribute("aria-expanded",i),n.setAttribute("aria-selected",i),e.setAttribute("aria-hidden",!i),r},this.addEvents=function(){return r.panes.forEach(function(t){var e,n,i,a,o=t.$button;o.addEventListener("click",(e=r.clickHandle.bind(r,o),n=150,a=void 0,function(){var t=this,r=arguments,o=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||e.apply(t,r)},n),o&&e.apply(t,r)})),o.addEventListener("touchstart",r.clickHandle.bind(r,o))}),r},this.removeEvents=function(){return r.panes.forEach(function(t){var e=t.$button;e.removeEventListener("click",r.clickHandle),e.removeEventListener("touchstart",r.clickHandle)}),r},this.expand=function(t){var e=r.panes[t],n=r.options,i=n.buttonActiveClass,a=n.contentActiveClass,o=n.closeOthers,s=r.current.index;o&&r.current&&s!==parseInt(t)&&r.current.open&&(r.current.state=r.current.machine[r.current.state].CLICK,r.collapse(s));var l=e.$target,c=e.$button;e.open=!0,r.current=e,l.style.display="block",l.style.height="";var u=l.getBoundingClientRect().height;return l.style.height=0,l.style.willChange="height",r.emit("open",{pane:e,index:t,panes:r.panes}),r.animate(0,Math.round(u),l).then(function(){r.onEnd(e),c.classList.add(i),l.classList.add(a),r.emit("after:open",{pane:e,index:t,panes:r.panes})}),r},this.collapse=function(t){var e=r.panes[t],n=r.options,i=n.buttonActiveClass,a=n.contentActiveClass,o=e.$target,s=e.$button;e.open=!1;var l=o.getBoundingClientRect().height;return o.style.height=l+"px",o.style.willChange="height",r.emit("close",{pane:e,index:t,panes:r.panes}),r.animate(Math.round(l),0,o).then(function(){r.onEnd(e),s.classList.remove(i),o.classList.remove(a),r.emit("after:close",{pane:e,index:t,panes:r.panes})}),r},this.init=function(){return r.createPanels(),r.addEvents(),r.$el.setAttribute("role","tablist"),r.$el.setAttribute("aria-multiselectable",r.options.closeOthers),r},this.destroy=function(){var t=r.options,e=t.buttonActiveClass,n=t.contentActiveClass;return r.removeEvents(),r.$el.removeAttribute("role"),r.$el.removeAttribute("aria-multiselectable"),r.panes.forEach(function(t){var i=t.$button,a=t.$target;i.classList.remove(e),i.removeAttribute("aria-expanded"),i.removeAttribute("aria-selected"),i.removeAttribute("aria-controls"),i.removeAttribute("role","tab"),a.removeAttribute("aria-hidden"),a.removeAttribute("aria-labelledby"),a.removeAttribute("role","tabpanel"),a.removeAttribute("data-enhanced",!0),a.classList.remove(n),a.removeAttribute("style"),r.off("*")}),r},this.options=n({},this.defaults,o),this.$el=i,this.panes=[],this.current=null,this.options.init&&this.init(),Object.assign(this,(a=a||Object.create(null),{on:function(t,e){(a[t]||(a[t]=[])).push(e)},off:function(t,e){a[t]&&a[t].splice(a[t].indexOf(e)>>>0,1)},emit:function(t,e){(a[t]||[]).slice().map(function(t){t(e)}),(a["*"]||[]).slice().map(function(n){n(t,e)})}})),this}});
